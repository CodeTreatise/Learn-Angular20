# Module 15.4: Angular CLI Beyond Basics

**Objective:** To explore advanced features and commands of the Angular CLI that can significantly boost developer productivity, streamline workflows, and enhance project management.

---

### The Angular CLI: Your Development Powerhouse

We've already used the Angular CLI for basic tasks like `ng new`, `ng serve`, `ng generate`, and `ng build`. However, the CLI offers a much deeper set of functionalities that can optimize your development process, especially in larger or more complex projects.

```mermaid
%%{init: {'theme':'neutral'}}%%
graph TD
    A[Angular CLI] --> B{Code Generation (Schematics)};
    A --> C{Project Management (Workspaces)};
    A --> D{Build & Serve Configuration};
    A --> E{Testing Utilities};
    A --> F{Dependency Management};
    A --> G{Advanced Commands};
```
**Alt text:** Diagram illustrating the various functionalities of the Angular CLI, including Code Generation (Schematics), Project Management (Workspaces), Build & Serve Configuration, Testing Utilities, Dependency Management, and other Advanced Commands.
**Alt text:** Diagram illustrating the various functionalities of the Angular CLI, including Code Generation (Schematics), Project Management (Workspaces), Build & Serve Configuration, Testing Utilities, Dependency Management, and other Advanced Commands.

--- 

### 1. Advanced Code Generation with Schematics

`ng generate` (or `ng g`) is powered by **Schematics**, a workflow tool for the modern web. Schematics can generate, modify, and refactor code in a consistent and automated way.

#### a) Generating Specific Elements

You can generate almost any Angular construct:

*   **Component:** `ng g c my-component`
*   **Service:** `ng g s my-service`
*   **Directive:** `ng g d my-directive`
*   **Pipe:** `ng g p my-pipe`
*   **Guard:** `ng g g my-guard`
*   **Interface:** `ng g interface my-interface`
*   **Class:** `ng g class my-class`

#### b) Useful Generation Flags

*   `--dry-run` (or `-d`): Shows what files would be generated without actually creating them. Always use this first!
    ```bash
    ng g c new-feature --dry-run
    ```
*   `--skip-tests` (or `-s`): Prevents the generation of `.spec.ts` test files.
    ```bash
    ng g s data-access --skip-tests
    ```
*   `--flat`: Prevents the creation of a new folder for the generated item (e.g., `ng g s data-access --flat` creates `data-access.service.ts` directly in the current folder).
*   `--project`: Specifies which project in a multi-project workspace to generate the item in.
*   `--module`: Automatically adds the generated component/directive/pipe to a specific `NgModule` (less relevant for standalone).
*   `--standalone`: Generates standalone components, directives, or pipes (default for new projects).

#### c) Custom Schematics

For larger teams or specific project needs, you can create your own custom schematics to automate repetitive tasks or enforce architectural patterns.

--- 

### 2. Project Management in Workspaces

Angular CLI supports **multi-project workspaces**, allowing you to manage multiple Angular applications and libraries within a single repository. This is the foundation for monorepos (as discussed in Module 11.1).

#### a) Creating a New Workspace (without an initial app)

```bash
ng new my-workspace --create-application=false
```

This creates an empty workspace. You can then add applications and libraries.

#### b) Adding Applications to a Workspace

```bash
ng generate application my-admin-app --standalone
```

#### c) Adding Libraries to a Workspace

Libraries are reusable codebases within your workspace. They are perfect for sharing components, services, or utility functions across multiple applications.

```bash
ng generate library shared-ui
```

Libraries are automatically configured for TypeScript path mapping, making imports easy:

```typescript
import { MyButtonComponent } from 'shared-ui'; // Assuming shared-ui is the library name
```

--- 

### 3. Advanced Build and Serve Configuration

#### a) Environment-Specific Builds

Angular allows you to define different environments (e.g., `development`, `staging`, `production`) and swap out configuration files during the build process.

*   **`src/environments/`:** Contains `environment.ts` (development) and `environment.prod.ts` (production).
*   **`angular.json`:** Configures which environment file to use for different build configurations.

```typescript
// src/environments/environment.ts
export const environment = {
  production: false,
  apiUrl: 'http://localhost:3000/api'
};

// src/environments/environment.prod.ts
export const environment = {
  production: true,
  apiUrl: 'https://api.yourdomain.com/api'
};
```

**Usage in component:**

```typescript
import { environment } from '../environments/environment';

// ...
const apiUrl = environment.apiUrl;
```

#### b) Custom Build Configurations

You can define custom build configurations in `angular.json` for specific needs (e.g., `test`, `staging`, `performance`).

```json
"configurations": {
  "production": { /* ... */ },
  "staging": {
    "fileReplacements": [
      {
        "replace": "src/environments/environment.ts",
        "with": "src/environments/environment.staging.ts"
      }
    ],
    "optimization": true,
    "outputHashing": "all",
    "sourceMap": false,
    "namedChunks": false
  }
}
```

Then build with: `ng build --configuration staging`

#### c) Proxying API Requests

During development, you often need to make API calls to a backend server running on a different port or domain. The CLI's development server can proxy these requests, avoiding CORS issues.

1.  **Create `proxy.conf.json`:**
    ```json
    {
      "/api": {
        "target": "http://localhost:3000",
        "secure": false,
        "changeOrigin": true
      }
    }
    ```
2.  **Start `ng serve` with proxy:**
    ```bash
    ng serve --proxy-config proxy.conf.json
    ```
    Now, requests to `/api/users` will be forwarded to `http://localhost:3000/api/users`.

--- 

### 4. Testing Utilities

#### a) Running Specific Tests

*   **Run a single test file:** `ng test --include src/app/my-component/my-component.component.spec.ts`
*   **Run tests matching a pattern:** `ng test --test-name-pattern "should create"`

#### b) Code Coverage

*   **Generate coverage report:** `ng test --code-coverage`
    This generates a `coverage/` folder with an HTML report showing how much of your code is covered by tests.

--- 

### 5. Dependency Management

#### a) `ng update`

*   **Update Angular packages:** `ng update @angular/cli @angular/core`
*   **Update all:** `ng update` (will suggest compatible updates)
*   **Migrate:** `ng update @angular/cli --migrate-only --from=16` (for major version migrations)

#### b) `ng lint`

*   **Run linter:** `ng lint` (or `npm run lint`)
    The CLI integrates with ESLint to enforce code style and best practices.

### 6. Other Useful Commands

*   **`ng version`:** Displays Angular CLI, Node.js, and other package versions.
*   **`ng config`:** Get or set configuration values in `angular.json`.
*   **`ng analytics`:** Configure Angular CLI usage analytics.

Mastering the Angular CLI beyond the basic commands is crucial for efficient and professional Angular development. It provides the tools to manage complex projects, optimize builds, and streamline your entire workflow.

---

**Previous:** [15.3 Angular DevTools](./15.3-angular-devtools.md)

**Next:** [15.5 Future Trends & Community](./15.5-future-trends-community.md)
