# Module 12.2: Internationalization (i18n)

**Objective:** To understand the concept of Internationalization (i18n) and Localization (l10n) and learn how to adapt an Angular application to support multiple languages and regions.

---

### The Global Audience: Why i18n Matters

In today's interconnected world, applications often need to serve users from diverse linguistic and cultural backgrounds. **Internationalization (i18n)** is the process of designing and developing an application in a way that makes it adaptable to various languages and regions without engineering changes.

**Localization (l10n)** is the process of adapting an internationalized application for a specific locale or market. This includes translating text, formatting dates, numbers, and currencies, and adapting to cultural conventions.

**Key Aspects of i18n/l10n:**

*   **Translation:** Text content (messages, labels, buttons) into different languages.
*   **Date and Time Formatting:** Displaying dates and times according to local conventions.
*   **Number and Currency Formatting:** Displaying numbers and currencies with correct separators and symbols.
*   **Pluralization:** Handling different plural forms for words.
*   **Text Direction:** Supporting Left-to-Right (LTR) and Right-to-Left (RTL) languages.

```mermaid
%%{init: {'theme':'neutral'}}%%
graph TD
    A[Internationalization (i18n)] --> B{Translation};
    A --> C{Date/Time Formatting};
    A --> D{Number/Currency Formatting};
    A --> E{Pluralization};
    A --> F{Text Direction (LTR/RTL)};

    B --> B1[Locale-specific files];
    C --> C1[Locale-specific rules];
```
**Alt text:** Diagram illustrating key aspects of Internationalization (i18n): Translation, Date/Time Formatting, Number/Currency Formatting, Pluralization, and Text Direction (LTR/RTL). Translation and Date/Time Formatting further branch into locale-specific files and rules respectively.

### Angular's i18n Approach

Angular has built-in support for i18n, primarily focusing on template translation. It uses a toolchain that extracts text from your templates, allows you to translate it, and then merges the translations back into your application during the build process.

#### 1. Marking Text for Translation

Angular uses the `i18n` attribute to mark elements or attributes for translation.

**Example:**

```html
<!-- Mark an element for translation -->
<h1 i18n>Welcome to our Application</h1>

<!-- Add a description for translators -->
<p i18n="@@welcomeMessage">A warm greeting to our users.</p>

<!-- Translate an attribute -->
<img src="assets/logo.png" i18n-alt="@@logoAlt" alt="Company Logo">

<!-- Translate with interpolation -->
<p i18n>Hello {{ name }}!</p>
```

*   `i18n`: Marks the content of the element for translation.
*   `i18n="@@id"`: Provides a unique ID for the translation unit, which is useful for managing translations.
*   `i18n-attr`: Marks a specific attribute for translation (e.g., `i18n-alt` for the `alt` attribute).

#### 2. Extracting Translation Files

After marking your text, you use the Angular CLI to extract these translation units into a source language file (e.g., XLIFF or XMB format).

```bash
ng extract-i18n --output-path src/locale
```

This command will generate a file like `messages.xlf` (or `messages.xmb`) in `src/locale`. This file contains all the text marked with `i18n` attributes.

**Example `messages.xlf` snippet:**

```xml
<trans-unit id="welcomeMessage" datatype="html">
  <source>A warm greeting to our users.</source>
  <target>A warm greeting to our users.</target>
  <context-group purpose="location">
    <context context-type="sourcefile">src/app/app.component.html</context>
    <context context-type="linenumber">2</context>
  </context-group>
</trans-unit>
```

#### 3. Translating the Content

Translators take the extracted file and provide translations for each `<source>` tag into the `<target>` tag. For each language you support, you'll create a separate translation file (e.g., `messages.fr.xlf` for French, `messages.es.xlf` for Spanish).

**Example `messages.fr.xlf`:**

```xml
<trans-unit id="welcomeMessage" datatype="html">
  <source>A warm greeting to our users.</source>
  <target>Un accueil chaleureux Ã  nos utilisateurs.</target>
  <context-group purpose="location">
    <context context-type="sourcefile">src/app/app.component.html</context>
    <context context-type="linenumber">2</context>
  </context-group>
</trans-unit>
```

#### 4. Building and Serving for Specific Locales

Angular applications are built for each locale. You configure this in `angular.json`.

**`angular.json` configuration:**

```json
"projects": {
  "my-app": {
    "i18n": {
      "sourceLocale": "en-US",
      "locales": {
        "fr": {
          "translation": "src/locale/messages.fr.xlf"
        },
        "es": {
          "translation": "src/locale/messages.es.xlf"
        }
      }
    },
    "architect": {
      "build": {
        "builder": "@angular-devkit/build-angular:browser",
        "options": { /* ... */ },
        "configurations": {
          "production": { /* ... */ },
          "fr": {
            "localize": ["fr"]
          },
          "es": {
            "localize": ["es"]
          }
        }
      },
      "serve": {
        "builder": "@angular-devkit/build-angular:dev-server",
        "configurations": {
          "fr": {
            "browserTarget": "my-app:build:development,fr"
          },
          "es": {
            "browserTarget": "my-app:build:development,es"
          }
        }
      }
    }
  }
}
```

**Building for a specific locale:**

```bash
ng build --configuration=fr
ng build --configuration=es
```

This will create separate bundles for each language (e.g., `dist/my-app/fr/` and `dist/my-app/es/`).

**Serving a specific locale:**

```bash
ng serve --configuration=fr
```

### Other i18n Considerations

#### 1. Date, Number, and Currency Formatting

Angular provides built-in pipes that automatically format dates, numbers, and currencies based on the active locale.

```html
<p>Date: {{ today | date:'medium' }}</p>
<p>Price: {{ productPrice | currency:'USD':'symbol':'1.2-2' }}</p>
<p>Number: {{ largeNumber | number:'1.0-0' }}</p>
```

These pipes use the browser's Internationalization API (`Intl`) to determine the correct formatting based on the locale set during the build process.

#### 2. Pluralization

Angular's `i18n` attribute supports pluralization rules using the ICU Message Format (`{VAR, plural, ...}`).

```html
<p i18n>{count, plural, =0 {No items} =1 {One item} other {{{count}} items}} in cart.</p>
```

#### 3. Text Direction (RTL/LTR)

For languages like Arabic or Hebrew, text flows from Right-to-Left (RTL). Angular supports this by allowing you to set the `dir` attribute on the `<html>` tag. When building for an RTL locale, Angular can automatically adjust styles (e.g., `margin-left` becomes `margin-right`).

#### 4. Third-Party Libraries

Ensure any third-party UI libraries (e.g., Angular Material) you use also support i18n and provide mechanisms for translation.

Internationalization is a complex but essential aspect of building global applications. Angular's built-in tools provide a solid foundation for translating your application's content and adapting it to various cultural conventions.

---

### Hands-on Exercise: Internationalize a Component

1.  **Create a new Angular project** or use an existing one.
2.  **Add i18n support** to your project by running `ng add @angular/localize`.
3.  **In a component's template (e.g., `app.component.html`):**
    *   Mark a simple heading for translation: `<h1 i18n>Welcome to our App!</h1>`.
    *   Mark a paragraph with an interpolation and a description: `<p i18n="@@greeting">Hello, {{ name }}!</p>` (where `name` is a property in your component).
    *   Mark an image's `alt` attribute for translation: `<img src="logo.png" i18n-alt="@@logoAlt" alt="Company Logo">`.
4.  **Extract the translation messages:** `ng extract-i18n --output-path src/locale`.
5.  **Create a French translation file (`src/locale/messages.fr.xlf`):** Copy the content from `messages.xlf` and translate the `<target>` tags to French.
6.  **Configure `angular.json`** to include the French locale and a build configuration for it.
7.  **Build your application for French:** `ng build --configuration=fr`.
8.  **Serve the French version:** `ng serve --configuration=fr`.
9.  **Verify:** Open your browser and confirm that the text is now in French.

---

**Previous:** [12.1 Security Best Practices](./12.1-security-best-practices.md)

**Next:** [12.3 Accessibility (a11y)](./12.3-accessibility.md)
